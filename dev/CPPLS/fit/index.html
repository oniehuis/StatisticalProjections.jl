<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Fit · CPPLS</title><meta name="title" content="Fit · CPPLS"/><meta property="og:title" content="Fit · CPPLS"/><meta property="twitter:title" content="Fit · CPPLS"/><meta name="description" content="Documentation for CPPLS."/><meta property="og:description" content="Documentation for CPPLS."/><meta property="twitter:description" content="Documentation for CPPLS."/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">CPPLS</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><span class="tocitem">CPPLS</span><ul><li><a class="tocitem" href="../theory/">Canonical Powered Partial Least Squares (CPPLS)</a></li><li><a class="tocitem" href="../types/">Types</a></li><li class="is-active"><a class="tocitem" href>Fit</a></li><li><a class="tocitem" href="../predict/">Predict</a></li><li><a class="tocitem" href="../crossvalidation/">Cross Validation</a></li><li><a class="tocitem" href="../visualization/">Visualization</a></li><li><a class="tocitem" href="../internal/">Internal</a></li></ul></li><li><span class="tocitem">Utils</span><ul><li><a class="tocitem" href="../../Utils/encoding/">Encoding</a></li><li><a class="tocitem" href="../../Utils/matrix/">Matrix</a></li><li><a class="tocitem" href="../../Utils/statistics/">Statistics</a></li><li><a class="tocitem" href="../../Utils/internal/">Internal</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">CPPLS</a></li><li class="is-active"><a href>Fit</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Fit</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/oniehuis/CPPLS.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/oniehuis/CPPLS.jl/blob/main/docs/src/CPPLS/fit.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Fit"><a class="docs-heading-anchor" href="#Fit">Fit</a><a id="Fit-1"></a><a class="docs-heading-anchor-permalink" href="#Fit" title="Permalink"></a></h1><article><details class="docstring" open="true"><summary id="CPPLS.fit_cppls"><a class="docstring-binding" href="#CPPLS.fit_cppls"><code>CPPLS.fit_cppls</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">fit_cppls(
    X::AbstractMatrix{&lt;:Real},
    Y::AbstractMatrix{&lt;:Real},
    n_components::Integer;
    gamma::Union{&lt;:Real, &lt;:NTuple{2, &lt;:Real}, &lt;:AbstractVector{&lt;:Union{&lt;:Real, &lt;:NTuple{2, &lt;:Real}}}}=0.5,
    observation_weights::Union{AbstractVector{&lt;:Real}, Nothing}=nothing,
    Y_auxiliary::Union{LinearAlgebra.AbstractVecOrMat, Nothing}=nothing,
    center::Bool=true,
    X_tolerance::Real=1e-12,
    X_loading_weight_tolerance::Real=eps(Float64), 
    gamma_rel_tol::Real=1e-6,
    gamma_abs_tol::Real=1e-12,
    t_squared_norm_tolerance::Real=1e-10,
    sample_labels::AbstractVector=String[],
    predictor_labels::AbstractVector=String[],
    response_labels::AbstractVector=String[])</code></pre><p>Fit a Canonical Powered Partial Least Squares (CPPLS) model.</p><p><strong>Arguments</strong></p><ul><li><code>X</code>: A matrix of predictor variables (observations × features). <code>NA</code>s and <code>Inf</code>s are not  allowed.</li><li><code>Y</code>: A matrix of response variables (observations × targets). <code>NA</code>s and <code>Inf</code>s are not  allowed.</li></ul><p><strong>Optional Positional Argument</strong></p><ul><li><code>n_components</code>: The number of components to extract in the CPPLS model. Defaults to 2.</li></ul><p><strong>Optional Keyword Arguments</strong></p><ul><li><code>gamma</code>: Either (i) a fixed power parameter (<code>γ</code>), (ii) a <code>(lo, hi)</code> tuple describing the bounds for per-component optimization, or (iii) a vector mixing both forms. Defaults to <code>0.5</code>, i.e. no optimization.</li><li><code>observation_weights</code>: A vector of individual weights for the observations (e.g.,  experimental data or samples). Defaults to <code>nothing</code>.</li><li><code>Y_auxiliary</code>: A matrix (or vector) of auxiliary response variables containing additional information  about the observations. Defaults to <code>nothing</code>.</li><li><code>center</code>: Whether to mean-center the <code>X</code> and <code>Y</code> matrices. Defaults to <code>true</code>.</li><li><code>X_tolerance</code>: Tolerance for small norms in <code>X</code>. Columns of <code>X</code> with norms below this  threshold are set to zero during deflation. Defaults to <code>1e-12</code>.</li><li><code>X_loading_weight_tolerance</code>: Tolerance for small weights. Elements of the weight vector  below this threshold are set to zero. Defaults to <code>eps(Float64)</code>.</li><li><code>gamma_rel_tol</code>: Relative tolerance for the γ optimizer. Defaults to <code>1e-6</code>.</li><li><code>gamma_abs_tol</code>: Absolute tolerance for the γ optimizer. Defaults to <code>1e-12</code>.</li><li><code>t_squared_norm_tolerance</code>: Small positive value added to near-zero score norms to keep downstream divisions stable. Defaults to <code>1e-10</code>.</li><li><code>sample_labels</code>: Optional labels describing each observation. Defaults to <code>String[]</code>.</li><li><code>predictor_labels</code>: Optional labels for the predictor columns (in order). Defaults to  <code>String[]</code>.</li><li><code>response_labels</code>: Optional labels for the response variables / classes (in order). Defaults to <code>String[]</code> for regressions. When passing categorical responses (see below), class labels are inferred automatically.</li><li><code>analysis_mode</code>: Internal flag distinguishing regression from discriminant analysis. Advanced callers can override this, but public wrappers set it automatically.</li><li><code>da_categories</code>: Original categorical responses for discriminant analysis. This is set by the label-based wrapper and must remain <code>nothing</code> for regression problems.</li></ul><p><strong>Returns</strong></p><p>A <code>CPPLS</code> object containing the following fields:</p><ul><li><code>regression_coefficients</code>: A 3D array of regression coefficients for 1, ...,  <code>n_components</code>.</li><li><code>X_scores</code>: A matrix of scores (latent variables) for the predictor matrix <code>X</code>.</li><li><code>X_loadings</code>: A matrix of loadings for the predictor matrix <code>X</code>.</li><li><code>X_loading_weights</code>: A matrix of loading weights for the predictor matrix <code>X</code>.</li><li><code>Y_scores</code>: A matrix of scores (latent variables) for the response matrix <code>Y</code>.</li><li><code>Y_loadings</code>: A matrix of loadings for the response matrix <code>Y</code>.</li><li><code>projection</code>: The projection matrix used to convert <code>X</code> to scores.</li><li><code>X_means</code>: A vector of means of the <code>X</code> variables (used for centering).</li><li><code>Y_means</code>: A vector of means of the <code>Y</code> variables (used for centering).</li><li><code>fitted_values</code>: An array of fitted values for the response matrix <code>Y</code>.</li><li><code>residuals</code>: An array of residuals for the response matrix <code>Y</code>.</li><li><code>X_variance</code>: A vector containing the amount of variance in <code>X</code> explained by each   component.</li><li><code>X_total_variance</code>: The total variance in <code>X</code>.</li><li><code>gammas</code>: The power parameter (<code>γ</code>) values obtained during power optimization.</li><li><code>canonical_correlations</code>: Canonical correlation values for each component.</li><li><code>small_norm_indices</code>: Indices of explanatory variables with norms close to or equal to   zero.</li><li><code>canonical_coefficients</code>: A matrix containing the canonical coefficients (<code>a</code>) from  canonical correlation analysis (<code>cor(Za, Yb)</code>).</li><li><code>canonical_coefficients_y</code>: A matrix containing the canonical coefficients (<code>b</code>) for the responses from canonical correlation analysis.</li><li><code>W0_weights</code>: Initial CPPLS weight matrices per component.</li><li><code>Z</code>: Supervised predictor projections per component (<code>X_deflated * W0_weights</code>).</li><li><code>sample_labels</code>: The provided sample labels (or an empty vector if none were supplied).</li><li><code>predictor_labels</code>: The provided predictor labels (or an empty vector).</li><li><code>response_labels</code>: The provided response labels (or an empty vector).</li><li><code>analysis_mode</code>: Tracks whether the model was fit for regression or discriminant analysis.</li><li><code>da_categories</code>: The original categorical responses for discriminant analysis (otherwise <code>nothing</code>).</li></ul><p><strong>Notes</strong></p><ul><li>The CPPLS model is an extension of Partial Least Squares (PLS) that incorporates  canonical correlation analysis (CCA) and power parameter optimization to maximize the  correlation between linear combinations of <code>X</code> and <code>Y</code>.</li><li>The power parameter (<code>γ</code>) controls the balance between variance maximization and  correlation maximization. It is optimized within the specified bounds (<code>gamma_bounds</code>).</li><li>If <code>Y_auxiliary</code> is provided, it is concatenated with <code>Y</code> to form a combined response  matrix (<code>Y_combined</code>), which is used during the fitting process.</li><li>Passing a categorical response vector instead of a numeric matrix automatically triggers the discriminant-analysis variant of <code>fit_cppls</code> and infers class labels.</li></ul><p><strong>Example</strong></p><pre><code class="language-julia hljs">julia&gt; X = Float64[1 0 2
                   0 1 2
                   1 1 1
                   2 3 0
                   3 2 1];

julia&gt; labels = [&quot;red&quot;, &quot;blue&quot;, &quot;red&quot;, &quot;blue&quot;, &quot;red&quot;];

julia&gt; Y, classes = labels_to_one_hot(labels);

julia&gt; model = fit_cppls(X, Y, 2; gamma=(0.7, 1.0));

julia&gt; model.X_means ≈ Matrix([1.4 1.4 1.2])

julia&gt; model.gammas ≈ [0.700185836799654, 0.9366214237592033]
true</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/oniehuis/CPPLS.jl/blob/71592a1be43cc22b25d1b96d7622ba37c6a931ac/src/CPPLS/fit.jl#L23-L144">source</a></section><section><div><pre><code class="language-julia hljs">fit_cppls(X, labels::AbstractCategoricalArray, n_components=2; kwargs...)
fit_cppls(X, labels::AbstractVector, n_components=2; kwargs...)</code></pre><p>Discriminant-analysis variants of <a href="#CPPLS.fit_cppls"><code>fit_cppls</code></a>. The first method dispatches specifically on <code>CategoricalVector</code>/<code>CategoricalArray</code> inputs so users can opt into DA behaviour through the type signature alone. The second method accepts any other label container (e.g. plain <code>Vector{String}</code> or <code>Vector{Symbol}</code>) but follows the exact same code path. Both convert the labels to a one-hot response matrix internally and store the inferred class names inside the returned <code>CPPLS</code> model.</p><p><strong>Example</strong></p><pre><code class="language-julia hljs">julia&gt; using CategoricalArrays

julia&gt; X = Float64[1 0; 0 1; 1 1; 2 1];

julia&gt; cat_labels = categorical([&quot;red&quot;, &quot;blue&quot;, &quot;red&quot;, &quot;blue&quot;]);

julia&gt; cppls_cat = fit_cppls(X, cat_labels, 2; gamma=0.5);

julia&gt; cppls_cat.analysis_mode
:discriminant

julia&gt; plain_labels = [&quot;red&quot;, &quot;blue&quot;, &quot;red&quot;, &quot;blue&quot;];

julia&gt; cppls_plain = fit_cppls(X, plain_labels, 2; gamma=0.5);

julia&gt; cppls_plain.response_labels == cppls_cat.response_labels
true</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/oniehuis/CPPLS.jl/blob/71592a1be43cc22b25d1b96d7622ba37c6a931ac/src/CPPLS/fit.jl#L303-L334">source</a></section><section><div><pre><code class="language-julia hljs">fit_cppls(X::AbstractMatrix{&lt;:Real}, y::AbstractVector{&lt;:Real}, n_components=2; kwargs...)</code></pre><p>Regression-friendly convenience wrapper around <a href="#CPPLS.fit_cppls"><code>fit_cppls</code></a> that accepts a single numeric response vector instead of a full response matrix. The vector is reshaped to <code>(n_samples, 1)</code> internally and all keyword arguments are forwarded to the standard matrix-based implementation.</p><p><strong>Example</strong></p><pre><code class="language-julia hljs">julia&gt; X = Float64[1 2; 3 4; 5 6];

julia&gt; y = [0.1, 0.5, 0.9];

julia&gt; model = fit_cppls(X, y, 2; gamma=0.5);

julia&gt; model.analysis_mode
:regression</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/oniehuis/CPPLS.jl/blob/71592a1be43cc22b25d1b96d7622ba37c6a931ac/src/CPPLS/fit.jl#L399-L418">source</a></section></details></article><article><details class="docstring" open="true"><summary id="CPPLS.fit_cppls_light"><a class="docstring-binding" href="#CPPLS.fit_cppls_light"><code>CPPLS.fit_cppls_light</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">fit_cppls_light(
    X::AbstractMatrix{&lt;:Real},
    Y::AbstractMatrix{&lt;:Real},
    n_components::Integer;
    gamma::Union{&lt;:Real, &lt;:NTuple{2, &lt;:Real}, &lt;:AbstractVector{&lt;:Union{&lt;:Real, &lt;:NTuple{2, &lt;:Real}}}}=0.5,
    observation_weights::Union{AbstractVector{&lt;:Real}, Nothing}=nothing,
    Y_auxiliary::Union{LinearAlgebra.AbstractVecOrMat, Nothing}=nothing,
    center::Bool=true,
    X_tolerance::Real=1e-12,
    X_loading_weight_tolerance::Real=eps(Float64),
    gamma_rel_tol::Real=1e-6,
    gamma_abs_tol::Real=1e-12,
    t_squared_norm_tolerance::Real=1e-10,
    analysis_mode::Symbol=:regression)</code></pre><p>Fit a CPPLS model but retain only the parts needed for prediction (<code>CPPLSLight</code>).</p><p>Arguments mirror <code>fit_cppls</code>, including support for scalar γ, <code>(lo, hi)</code> bounds, or vectors that mix scalars and tuples as candidate sets. The returned <code>CPPLSLight</code> stores only the stacked regression coefficients plus the <code>X</code>/<code>Y</code> centering means.  <code>analysis_mode</code> is an internal keyword that tags the resulting object as either a regression or discriminant model; most users rely on the wrappers below instead of setting it manually.</p><p><strong>Notes</strong></p><ul><li>Use this when you only need predictions, not the intermediate diagnostics.</li><li>The same preprocessing, weighting, and tolerance settings apply as in <code>fit_cppls</code>.</li></ul><p><strong>Example</strong></p><pre><code class="language-julia hljs">julia&gt; X = Float64[1 0 2
                   0 1 2
                   1 1 1
                   2 3 0
                   3 2 1];

julia&gt; labels = [&quot;red&quot;, &quot;blue&quot;, &quot;red&quot;, &quot;blue&quot;, &quot;red&quot;];

julia&gt; Y, classes = labels_to_one_hot(labels);

julia&gt; model = fit_cppls_light(X, Y, 2; gamma=(0.7, 1.0));

julia&gt; model.X_means ≈ Matrix([1.4 1.4 1.2])
true</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/oniehuis/CPPLS.jl/blob/71592a1be43cc22b25d1b96d7622ba37c6a931ac/src/CPPLS/fit.jl#L459-L505">source</a></section><section><div><pre><code class="language-julia hljs">fit_cppls_light(X, labels::AbstractCategoricalArray, n_components=2; kwargs...)
fit_cppls_light(X, labels::AbstractVector, n_components=2; kwargs...)</code></pre><p>Discriminant-analysis convenience wrappers for <a href="#CPPLS.fit_cppls_light"><code>fit_cppls_light</code></a>. The first signature dispatches explicitly on categorical arrays so callers can rely on the method table to distinguish regression from DA. The second accepts any other label container (e.g. vectors of strings, symbols, or enums) and forwards into the same code path. Regardless of signature, labels are converted to a one-hot matrix for fitting, class names are inferred once, and the returned <code>CPPLSLight</code> only retains the components needed for prediction.</p><p><strong>Example</strong></p><pre><code class="language-julia hljs">julia&gt; using CategoricalArrays

julia&gt; X = Float64[1 0; 0 1; 1 1; 2 1];

julia&gt; labels = categorical([&quot;classA&quot;, &quot;classB&quot;, &quot;classA&quot;, &quot;classB&quot;]);

julia&gt; light_cat = fit_cppls_light(X, labels, 2; gamma=0.5);

julia&gt; light_cat.analysis_mode
:discriminant

julia&gt; light_plain = fit_cppls_light(X, [&quot;classA&quot;, &quot;classB&quot;, &quot;classA&quot;, &quot;classB&quot;], 2; gamma=0.5);

julia&gt; light_plain.regression_coefficients ≈ light_cat.regression_coefficients
true</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/oniehuis/CPPLS.jl/blob/71592a1be43cc22b25d1b96d7622ba37c6a931ac/src/CPPLS/fit.jl#L583-L613">source</a></section><section><div><pre><code class="language-julia hljs">fit_cppls_light(X::AbstractMatrix{&lt;:Real}, y::AbstractVector{&lt;:Real}, n_components=2; kwargs...)</code></pre><p>Regression convenience wrapper for <a href="#CPPLS.fit_cppls_light"><code>fit_cppls_light</code></a> that accepts a single numeric response vector. Internally reshapes <code>y</code> to <code>(n_samples, 1)</code> and forwards all keyword arguments to the matrix-based implementation.</p><p><strong>Example</strong></p><pre><code class="language-julia hljs">julia&gt; X = Float64[1 2; 3 4; 5 6];

julia&gt; y = [0.1, 0.5, 0.9];

julia&gt; light = fit_cppls_light(X, y, 2; gamma=0.5);

julia&gt; light.analysis_mode
:regression</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/oniehuis/CPPLS.jl/blob/71592a1be43cc22b25d1b96d7622ba37c6a931ac/src/CPPLS/fit.jl#L665-L683">source</a></section></details></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../types/">« Types</a><a class="docs-footer-nextpage" href="../predict/">Predict »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.16.1 on <span class="colophon-date" title="Sunday 21 December 2025 19:39">Sunday 21 December 2025</span>. Using Julia version 1.12.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
