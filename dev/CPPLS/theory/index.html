<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Canonical Powered Partial Least Squares (CPPLS) · CPPLS</title><meta name="title" content="Canonical Powered Partial Least Squares (CPPLS) · CPPLS"/><meta property="og:title" content="Canonical Powered Partial Least Squares (CPPLS) · CPPLS"/><meta property="twitter:title" content="Canonical Powered Partial Least Squares (CPPLS) · CPPLS"/><meta name="description" content="Documentation for CPPLS."/><meta property="og:description" content="Documentation for CPPLS."/><meta property="twitter:description" content="Documentation for CPPLS."/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">CPPLS</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><span class="tocitem">CPPLS</span><ul><li class="is-active"><a class="tocitem" href>Canonical Powered Partial Least Squares (CPPLS)</a></li><li><a class="tocitem" href="../types/">Types</a></li><li><a class="tocitem" href="../fit/">Fit</a></li><li><a class="tocitem" href="../predict/">Predict</a></li><li><a class="tocitem" href="../crossvalidation/">Cross Validation</a></li><li><a class="tocitem" href="../visualization/">Visualization</a></li><li><a class="tocitem" href="../internal/">Internal</a></li></ul></li><li><span class="tocitem">Utils</span><ul><li><a class="tocitem" href="../../Utils/encoding/">Encoding</a></li><li><a class="tocitem" href="../../Utils/matrix/">Matrix</a></li><li><a class="tocitem" href="../../Utils/statistics/">Statistics</a></li><li><a class="tocitem" href="../../Utils/internal/">Internal</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">CPPLS</a></li><li class="is-active"><a href>Canonical Powered Partial Least Squares (CPPLS)</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Canonical Powered Partial Least Squares (CPPLS)</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/oniehuis/CPPLS.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/oniehuis/CPPLS.jl/blob/main/docs/src/CPPLS/theory.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Canonical-Powered-Partial-Least-Squares-(CPPLS)"><a class="docs-heading-anchor" href="#Canonical-Powered-Partial-Least-Squares-(CPPLS)">Canonical Powered Partial Least Squares (CPPLS)</a><a id="Canonical-Powered-Partial-Least-Squares-(CPPLS)-1"></a><a class="docs-heading-anchor-permalink" href="#Canonical-Powered-Partial-Least-Squares-(CPPLS)" title="Permalink"></a></h1><p>Canonical Powered Partial Least Squares (CPPLS) is a supervised projection method for regression and classification. Its purpose is to extract latent components that summarize the predictor matrix <span>$X \in \mathbb{R}^{n \times p}$</span> in a way that best reflects the structure in a multivariate response matrix <span>$Y \in \mathbb{R}^{n \times q}$</span>. The method extends standard PLS in three important ways. First, it allows multiple response variables, including both primary responses that one wishes to predict and optional auxiliary responses that guide the extraction of components. Second, it incorporates a power parameter <span>$\gamma$</span> that controls the balance between predictor variance and predictor–response correlation, giving the user explicit control over how strongly the model should emphasize correlation structure. Third, CPPLS can operate with a vector of non-negative sample weights, allowing some observations to contribute more or less to the fitted model. This is useful when classes are unbalanced, when some samples are more reliable, or when experimental design considerations suggest that certain samples should carry greater influence.</p><p>Each CPPLS component is extracted in two conceptual stages. First, the predictors are projected onto supervised directions, one for each column of <span>$Y$</span>, using the <span>$\gamma$</span>-controlled mixture of weighted predictor variance and weighted predictor–response correlation. Second, a canonical correlation analysis (CCA) determines how these supervised directions should be linearly combined into a single latent variable that is optimally aligned with the primary responses. Auxiliary responses and observation weights enter the computation of supervised directions in the first stage, shaping the latent space that is subsequently analyzed by CCA, while the CCA itself is guided solely by the primary responses under the same weighting structure.</p><p>To begin, <span>$X$</span> and <span>$Y$</span> are centered using the supplied sample weights. If <span>$w_i$</span> is the weight of sample <span>$i$</span> and the weights are normalized to sum to one, the weighted mean of a variable <span>$x$</span> becomes</p><p class="math-container">\[\bar{x} = \sum_i w_i x_i .\]</p><p>All variances, covariances, and correlations are computed in a weighted sense. For a centered variable <span>$x$</span>, the weighted variance is</p><p class="math-container">\[\operatorname{Var}_w(x) = \sum_i w_i x_i^2 ,\]</p><p>and for two centered variables <span>$x$</span> and <span>$y$</span>, the weighted covariance is</p><p class="math-container">\[\operatorname{Cov}_w(x,y) = \sum_i w_i x_i y_i .\]</p><p>Weighted correlations are obtained by normalizing the weighted covariance by the corresponding weighted standard deviations.</p><p>CPPLS constructs a supervised transformation matrix by combining predictor scale and predictor–response correlation, with the balance controlled by the power parameter <span>$\gamma \in (0,1)$</span>. For each predictor <span>$x_j$</span> (a column of <span>$X$</span>) and each response <span>$y_k$</span> (a column of <span>$Y$</span>), CPPLS computes the weighted standard deviation <span>$\operatorname{std}_w(x_j)$</span> and the weighted correlation <span>$\operatorname{corr}_w(x_j,y_k)$</span>. These quantities are not combined additively, but multiplicatively through <span>$\gamma$</span>-dependent powers.</p><p>The resulting supervised weight matrix is</p><p class="math-container">\[W_0(\gamma) \in \mathbb{R}^{p \times q},\]</p><p>where <span>$p$</span> is the number of predictors and <span>$q$</span> is the number of response columns, including auxiliary ones. It can be written as a product of a diagonal scale matrix and a correlation matrix,</p><p class="math-container">\[W_0(\gamma) = S_x(\gamma)\,C(\gamma),\]</p><p>with diagonal entries</p><p class="math-container">\[S_x(\gamma)_{jj} = \operatorname{std}_w(x_j)^{\frac{1-\gamma}{\gamma}},\]</p><p>and correlation entries</p><p class="math-container">\[C(\gamma)_{jk} = \operatorname{sign}\!\big(\operatorname{corr}_w(x_j,y_k)\big)\, \left|\operatorname{corr}_w(x_j,y_k)\right|^{\frac{\gamma}{1-\gamma}} .\]</p><p>Thus, each entry of <span>$W_0(\gamma)$</span> is proportional to a product of a predictor-scale term and a predictor–response correlation term, each raised to a power determined by <span>$\gamma$</span>. When <span>$\gamma$</span> is small, predictors with large weighted standard deviation are emphasized; when <span>$\gamma$</span> approaches one, predictors that are strongly correlated with the responses dominate. In traditional PLS workflows, predictor scaling is often used to control whether high-variance variables dominate the model. In CPPLS, the relative influence of predictor scale and predictor–response correlation is instead controlled explicitly through the power parameter <span>$\gamma$</span> within the weight construction. This reduces the need for separate scaling decisions as a preprocessing step.</p><p>Each column of <span>$W_0(\gamma)$</span> admits a direct geometric interpretation. For each response variable <span>$y_k$</span>, CPPLS constructs a direction in the original predictor space that emphasizes predictors with large weighted variance and predictors that are strongly correlated with that response, with the balance controlled by the power parameter <span>$\gamma$</span>. These directions represent response-specific supervised views of the predictor space.</p><p>Projecting the predictor matrix onto these directions,</p><p class="math-container">\[Z(\gamma) = X W_0(\gamma), \]</p><p>maps each sample from the original <span>$p$</span>-dimensional predictor space into a <span>$q$</span>-dimensional supervised space, where each coordinate summarizes the sample along a direction tailored to one column of <span>$Y$</span>. Auxiliary response variables contribute additional supervised directions and thereby enrich this intermediate representation. In this sense, <span>$W_0(\gamma)$</span> defines a supervised low-dimensional coordinate system for the predictors. Every entry in <span>$Z(\gamma) = X W_0(\gamma)$</span> is a single scalar summary value for a sample in the supervised direction associated with a response column. This representation is an intermediate supervised projection of <span>$X$</span> and does not yet define a CPPLS component; rather, it provides the response-guided axes that are subsequently combined by canonical correlation analysis to form the final latent component.</p><p>To choose the power parameter <span>$\gamma$</span>, CPPLS evaluates a grid of candidate values. For each candidate <span>$\gamma$</span>, it constructs the supervised compression</p><p class="math-container">\[Z(\gamma) = X W_0(\gamma), \]</p><p>where the matrix <span>$W_0(\gamma)$</span> depends on <span>$\gamma$</span> through a power-based trade-off between predictor scale, represented by weighted standard deviations, and predictor–response association, represented by weighted correlations. CPPLS then performs a weighted canonical correlation analysis between <span>$Z(\gamma)$</span> and the primary response block <span>$Y_{\mathrm{prim}}$</span>, and records the first (largest) canonical correlation</p><p class="math-container">\[\rho_1(\gamma) = \operatorname{ccorr}_w\!\big(Z(\gamma),\, Y_{\mathrm{prim}}\big) \]</p><p>as a score for that value of <span>$\gamma$</span>. The optimal value</p><p class="math-container">\[\gamma_{\mathrm{best}} = \arg\max_{\gamma \in \mathcal{G}} \rho_1(\gamma)\]</p><p>is therefore the <span>$\gamma$</span> whose variance–correlation–weighted construction of <span>$Z(\gamma)$</span> yields a representation of <span>$X$</span> that is maximally aligned, in the canonical correlation sense, with the primary responses. This step does not yet extract latent components or deflate the data; it only compares candidate supervised representations under identical conditions in order to select <span>$\gamma$</span>.</p><p>Once the optimal <span>$\gamma$</span> has been determined, CPPLS recomputes</p><p class="math-container">\[Z = Z(\gamma_{\mathrm{best}})\]</p><p>and performs a full weighted CCA between this matrix and the primary response columns of <span>$Y$</span>. The result is a canonical direction <span>$a$</span> in the <span>$Z$</span>-space and a corresponding direction <span>$b$</span> in the primary response space. The direction <span>$a$</span> specifies how to combine the supervised directions in <span>$Z$</span> into one axis that maximally correlates with the primary responses.  Providing <span>$Y_{\mathrm{aux}}$</span> changes the supervised directions <span>$W_0$</span>, so the intermediate representation <span>$Z = X W_0$</span> reflects both the primary responses and auxiliary structure. The CCA direction <span>$a$</span> is then chosen in this augmented space, which can rotate it toward directions that are jointly aligned with <span>$Y_{\mathrm{prim}}$</span> and <span>$Y_{\mathrm{aux}}$</span>. This helps prevent variance that is mainly explained by <span>$Y_{\mathrm{aux}}$</span> from being misattributed to <span>$Y_{\mathrm{prim}}$</span>.</p><p>The canonical direction is then mapped back into the predictor space through</p><p class="math-container">\[w = W_0(\gamma_{\mathrm{best}})\, a ,\]</p><p>producing the final CPPLS weight vector. This vector lies in the original predictor space and defines the direction used to compute the component score</p><p class="math-container">\[t = X w .\]</p><p>The component score <span>$t$</span> acts as a latent one-dimensional slider: each sample receives a coordinate <span>$t_i$</span>, and moving along this latent axis corresponds to sliding along the component in predictor space. The relationship between the component and the original variables is captured by the loadings. The weighted X-loading is given by</p><p class="math-container">\[p = \frac{X^\top W t}{t^\top W t},\]</p><p>which is the weighted regression of the predictors on the component. It describes how each predictor changes as one moves along <span>$t$</span>. The weighted Y-loading</p><p class="math-container">\[c = \frac{Y^\top W t}{t^\top W t}\]</p><p>describes how each response variable—including auxiliary responses when present—varies with the component under the weighting structure.</p><p>Deflation removes the part of <span>$X$</span> and <span>$Y$</span> that can be explained by this component:</p><p class="math-container">\[X \leftarrow X - t p^\top,\qquad
Y \leftarrow Y - t c^\top .\]</p><p>After this deflation, the dominant species structure has been removed from both <span>$X$</span> and <span>$Y$</span>. Because subsequent components are extracted from these residuals, they often describe remaining structured variation—such as seasonal drift or batch effects—rather than additional species separation. This does not impair discrimination: the first component captures the primary class separation, and later components model the remaining confounding structure, improving stability and interpretability.</p><p>Sample weighting becomes particularly important in discriminant analysis (CPPLS-DA) when classes are unbalanced or when certain samples are more reliable. For example, if one species has 20 samples and another 60, the unweighted analysis gives the larger class three times the influence on variances and correlations, and thus on the supervised compression. This often causes the dominant component to reflect within-class variation of the majority class rather than the between-class difference one intends to model. By assigning larger weights to minority-class samples and smaller weights to majority-class samples, the total effective weight of each class becomes balanced. All weighted variances, covariances, and correlations then reflect this adjusted influence, and the extracted components focus on genuine between-class separation rather than being overwhelmed by the larger class. Similarly, samples known to be noisy or unreliable can be down-weighted, while representative or carefully controlled samples can be up-weighted, improving the robustness of the extracted components.</p><p>A concrete example illustrates the benefit of combining auxiliary responses and sample weighting. Suppose two insect species are analyzed by GC–MS to characterize their cuticular hydrocarbons. The primary task is to discriminate species, but chemical profiles change with season, and species may not be collected uniformly throughout the year. In this situation, the largest variation in <span>$X$</span> may reflect seasonal drift rather than species. Even if the response <span>$Y$</span> encodes only species, the supervised compression may inadvertently emphasize seasonal structure, because GC–MS peaks that vary with season often correlate indirectly with species when sampling times differ. Including sampling date or season as an auxiliary Y-column provides CPPLS with a supervised direction dedicated to seasonal variation, preventing this structure from leaking into the species component. If sampling imbalance is also present—say one species is collected mostly early in the season and the other mostly later—assigning balanced sample weights prevents the majority class or sampling pattern from dominating the supervised compression. Together, auxiliary <span>$Y$</span> and sample weighting produce a far more stable and interpretable latent structure, with the X-loadings highlight species-specific signal.</p><p>After all components are extracted, regression coefficients for predicting the primary responses are assembled using</p><p class="math-container">\[B =
W_{\mathrm{comp}}
\left( P^\top W_{\mathrm{comp}} \right)^{-1}
C_{\mathrm{primary}}^\top ,\]</p><p>where <span>$W_{\mathrm{comp}}$</span> contains the component weight vectors, <span>$P$</span> the corresponding X-loadings, and <span>$C_{\mathrm{primary}}$</span> the primary Y-loadings. Auxiliary responses influence the latent components but do not appear in the final regression model unless explicitly designated as prediction targets.</p><p>In summary, CPPLS combines three complementary forms of supervision: the power parameter <span>$\gamma$</span> that controls the balance between variance and correlation, auxiliary responses that provide additional structured guidance for the supervised compression, and sample weights that ensure appropriate influence of different samples or classes. Together, these features allow CPPLS to build stable, interpretable, and discriminative models even in complex, high-dimensional, and confounded data settings.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../../">« Home</a><a class="docs-footer-nextpage" href="../types/">Types »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.16.1 on <span class="colophon-date" title="Sunday 21 December 2025 19:29">Sunday 21 December 2025</span>. Using Julia version 1.12.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
