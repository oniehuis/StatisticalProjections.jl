<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Canonical Powered Partial Least Squares (CPPLS) · StatisticalProjections</title><meta name="title" content="Canonical Powered Partial Least Squares (CPPLS) · StatisticalProjections"/><meta property="og:title" content="Canonical Powered Partial Least Squares (CPPLS) · StatisticalProjections"/><meta property="twitter:title" content="Canonical Powered Partial Least Squares (CPPLS) · StatisticalProjections"/><meta name="description" content="Documentation for StatisticalProjections."/><meta property="og:description" content="Documentation for StatisticalProjections."/><meta property="twitter:description" content="Documentation for StatisticalProjections."/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">StatisticalProjections</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><span class="tocitem">CPPLS</span><ul><li class="is-active"><a class="tocitem" href>Canonical Powered Partial Least Squares (CPPLS)</a></li><li><a class="tocitem" href="../types/">Types</a></li><li><a class="tocitem" href="../fit/">Fit</a></li><li><a class="tocitem" href="../predict/">Predict</a></li><li><a class="tocitem" href="../crossvalidation/">Cross Validation</a></li><li><a class="tocitem" href="../visualization/">Visualization</a></li><li><a class="tocitem" href="../internal/">Internal</a></li></ul></li><li><span class="tocitem">Utils</span><ul><li><a class="tocitem" href="../../Utils/encoding/">Encoding</a></li><li><a class="tocitem" href="../../Utils/matrix/">Matrix</a></li><li><a class="tocitem" href="../../Utils/statistics/">Statistics</a></li><li><a class="tocitem" href="../../Utils/internal/">Internal</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">CPPLS</a></li><li class="is-active"><a href>Canonical Powered Partial Least Squares (CPPLS)</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Canonical Powered Partial Least Squares (CPPLS)</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/oniehuis/StatisticalProjections.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/oniehuis/StatisticalProjections.jl/blob/main/docs/src/CPPLS/theory.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Canonical-Powered-Partial-Least-Squares-(CPPLS)"><a class="docs-heading-anchor" href="#Canonical-Powered-Partial-Least-Squares-(CPPLS)">Canonical Powered Partial Least Squares (CPPLS)</a><a id="Canonical-Powered-Partial-Least-Squares-(CPPLS)-1"></a><a class="docs-heading-anchor-permalink" href="#Canonical-Powered-Partial-Least-Squares-(CPPLS)" title="Permalink"></a></h1><p>Canonical Powered Partial Least Squares (CPPLS) is a supervised projection method for regression and classification. Its purpose is to extract latent components that summarize the predictor matrix <span>$X \in \mathbb{R}^{n \times p}$</span> in a way that best reflects the structure in a multivariate response matrix <span>$Y \in \mathbb{R}^{n \times q}$</span>. The method extends standard PLS in three important ways. First, it allows multiple response variables, including both primary responses that one wishes to predict and optional auxiliary responses that guide the extraction of components. Second, it incorporates a power parameter <span>$\gamma$</span> that controls the balance between predictor variance and predictor–response correlation, giving the user explicit control over how strongly the model should emphasize correlation structure. Third, CPPLS can operate with a vector of non-negative sample weights, allowing some observations to contribute more or less to the fitted model. This is useful when classes are unbalanced, when some samples are more reliable, or when experimental design considerations suggest that certain samples should carry greater influence.</p><p>Each CPPLS component is extracted in two conceptual stages. First, the predictors are projected onto supervised directions, one for each column of <span>$Y$</span>, using the <span>$\gamma$</span>-controlled mixture of weighted predictor variance and weighted predictor–response correlation. Second, a canonical correlation analysis (CCA) determines how these supervised directions should be linearly combined into a single latent variable that is optimally aligned with the primary responses. Auxiliary responses and observation weights enter the computation of supervised directions in the first stage, shaping the latent space that is subsequently analyzed by CCA, while the CCA itself is guided solely by the primary responses under the same weighting structure.</p><p>To begin, <span>$X$</span> and <span>$Y$</span> are centered (and optionally scaled) using the supplied sample weights. If <span>$w_i$</span> is the weight of sample <span>$i$</span> and the weights are normalized to sum to one, the weighted mean of a variable <span>$x$</span> becomes</p><p class="math-container">\[\bar{x} = \sum_i w_i x_i ,\]</p><p>and weighted inner products</p><p class="math-container">\[\langle u, v \rangle_w = \sum_i w_i u_i v_i\]</p><p>define all covariances. CPPLS computes, for each predictor in <span>$X$</span>, its weighted variance and its weighted covariance with each column of <span>$Y$</span>. These two quantities are blended according to the power parameter <span>$\gamma$</span>. When <span>$\gamma$</span> is small, predictor variance carries more influence; when <span>$\gamma$</span> approaches one, the emphasis shifts to predictor–response correlation. This results in a supervised weight matrix</p><p class="math-container">\[W_0(\gamma) \in \mathbb{R}^{p \times q},\]</p><p>where <span>$p$</span> is the number of predictors and <span>$q$</span> is the number of response columns, including auxiliary ones. Each column of <span>$W_0(\gamma)$</span> is a supervised direction in the original predictor space. If auxiliary responses are supplied, they contribute additional columns and thereby enrich the set of supervised directions. Because the construction of <span>$W_0(\gamma)$</span> uses the sample weights, heavily weighted samples exert proportionally greater influence on the supervised compression.</p><p>Multiplying the predictor matrix by this weight matrix gives the <span>$\gamma$</span>-dependent supervised compression</p><p class="math-container">\[Z(\gamma) = X W_0(\gamma),\]</p><p>which has the same number of samples as <span>$X$</span> but one column for each response variable. Every entry in <span>$Z(\gamma)$</span> is a single summary value for a sample in the supervised direction associated with a response column. Auxiliary responses provide additional supervised views of the data, and sample weights ensure that classes or samples with higher weights have greater influence on how these supervised directions are shaped.</p><p>To determine the optimal balance between variance and correlation, CPPLS evaluates a grid of <span>$\gamma$</span>-values. For each candidate <span>$\gamma$</span>, CPPLS computes <span>$Z(\gamma)$</span> and performs a weighted canonical correlation analysis between <span>$Z(\gamma)$</span> and the primary responses. Only the first canonical correlation is kept and serves as a score indicating how well that <span>$\gamma$</span> captures structure relevant to the primary response. The optimal value <span>$\gamma_{\mathrm{best}}$</span> is the one maximizing this weighted canonical correlation. This step does not yet produce components or deflate the data; it merely evaluates each candidate <span>$\gamma$</span> under identical conditions.</p><p>Once the optimal <span>$\gamma$</span> has been determined, CPPLS recomputes</p><p class="math-container">\[Z = Z(\gamma_{\mathrm{best}})\]</p><p>and performs a full weighted CCA between this matrix and the primary response columns of <span>$Y$</span>. The result is a canonical direction <span>$a$</span> in the <span>$Z$</span>-space and a corresponding direction <span>$b$</span> in the primary response space. The direction <span>$a$</span> specifies how to combine the supervised directions in <span>$Z$</span> into one axis that maximally correlates with the primary responses. Auxiliary responses influence this direction indirectly, since they have already shaped the supervised directions in <span>$W_0(\gamma_{\mathrm{best}})$</span>. The canonical direction is then mapped back into the predictor space through</p><p class="math-container">\[w = W_0(\gamma_{\mathrm{best}})\, a ,\]</p><p>producing the final CPPLS weight vector. This vector lies in the original predictor space and defines the direction used to compute the component score</p><p class="math-container">\[t = X w .\]</p><p>The component score <span>$t$</span> acts as a latent one-dimensional slider: each sample receives a coordinate <span>$t_i$</span>, and moving along this latent axis corresponds to sliding along the component in predictor space. The relationship between the component and the original variables is captured by the loadings. The weighted X-loading is given by</p><p class="math-container">\[p = \frac{X^\top W t}{t^\top W t},\]</p><p>which is the weighted regression of the predictors on the component. It describes how each predictor changes as one moves along <span>$t$</span>. The weighted Y-loading</p><p class="math-container">\[c = \frac{Y^\top W t}{t^\top W t}\]</p><p>describes how each response variable—including auxiliary responses when present—varies with the component under the weighting structure.</p><p>Deflation removes the part of <span>$X$</span> and <span>$Y$</span> that can be explained by this component:</p><p class="math-container">\[X \leftarrow X - t p^\top,\qquad
Y \leftarrow Y - t c^\top .\]</p><p>After this deflation, the dominant species structure has been removed from both <span>$X$</span> and <span>$Y$</span>. Because subsequent components are extracted from these residuals, they often describe remaining structured variation—such as seasonal drift or batch effects—rather than additional species separation. This does not impair discrimination: the first component captures the primary class separation, and later components model the remaining confounding structure, improving stability and interpretability.</p><p>Sample weighting becomes particularly important in discriminant analysis (CPPLS-DA) when classes are unbalanced or when certain samples are more reliable. For example, if one species has 20 samples and another 60, the unweighted analysis gives the larger class three times the influence on variances and correlations, and thus on the supervised compression. This often causes the dominant component to reflect within-class variation of the majority class rather than the between-class difference one intends to model. By assigning larger weights to minority-class samples and smaller weights to majority-class samples, the total effective weight of each class becomes balanced. All weighted variances, covariances, and correlations then reflect this adjusted influence, and the extracted components focus on genuine between-class separation rather than being overwhelmed by the larger class. Similarly, samples known to be noisy or unreliable can be down-weighted, while representative or carefully controlled samples can be up-weighted, improving the robustness of the extracted components.</p><p>A concrete example illustrates the benefit of combining auxiliary responses and sample weighting. Suppose two insect species are analyzed by GC–MS to characterize their cuticular hydrocarbons. The primary task is to discriminate species, but chemical profiles change with season, and species may not be collected uniformly throughout the year. In this situation, the largest variation in <span>$X$</span> may reflect seasonal drift rather than species. Even if the response <span>$Y$</span> encodes only species, the supervised compression may inadvertently emphasize seasonal structure, because GC–MS peaks that vary with season often correlate indirectly with species when sampling times differ. Including sampling date or season as an auxiliary Y-column provides CPPLS with a supervised direction dedicated to seasonal variation, preventing this structure from leaking into the species component. If sampling imbalance is also present—say one species is collected mostly early in the season and the other mostly later—assigning balanced sample weights prevents the majority class or sampling pattern from dominating the supervised compression. Together, auxiliary <span>$Y$</span> and sample weighting produce a far more stable and interpretable latent structure: the first component becomes species-focused, while secondary components capture the residual seasonal drift or other confounders. X-loadings highlight species-specific peaks, while seasonal peaks are isolated to components guided by the auxiliary response.</p><p>After all components are extracted, regression coefficients for predicting the primary responses are assembled using</p><p class="math-container">\[B =
W_{\mathrm{comp}}
\left( P^\top W_{\mathrm{comp}} \right)^{-1}
C_{\mathrm{primary}}^\top ,\]</p><p>where <span>$W_{\mathrm{comp}}$</span> contains the component weight vectors, <span>$P$</span> the corresponding X-loadings, and <span>$C_{\mathrm{primary}}$</span> the primary Y-loadings. Auxiliary responses influence the latent components but do not appear in the final regression model unless explicitly designated as prediction targets.</p><p>In summary, CPPLS combines three complementary forms of supervision: the power parameter <span>$\gamma$</span> that controls the balance between variance and correlation, auxiliary responses that provide additional structured guidance for the supervised compression, and sample weights that ensure appropriate influence of different samples or classes. Together, these features allow CPPLS to build stable, interpretable, and discriminative models even in complex, high-dimensional, and confounded data settings.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../../">« Home</a><a class="docs-footer-nextpage" href="../types/">Types »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.16.1 on <span class="colophon-date" title="Thursday 11 December 2025 05:56">Thursday 11 December 2025</span>. Using Julia version 1.12.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
